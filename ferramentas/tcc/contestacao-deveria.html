<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desconstruindo o "Deveria" | Bruno de Souza</title>
    
    <script>
        if(localStorage.getItem('logado') !== 'sim') {
            window.location.href = "../../login.html";
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            --bg-color: #f0f8ff;
            --primary: #6c5ce7;
            --primary-dark: #5849be;
            --accent: #00cec9;
            --text: #2d3436;
            --range-track: #dfe6e9;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bg-color);
            background-image: radial-gradient(#dfe6e9 2px, transparent 2px);
            background-size: 20px 20px;
            margin: 0; padding: 20px;
            color: var(--text);
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
        }

        /* --- HEADER --- */
        header {
            text-align: center; margin-bottom: 30px;
            background: white; padding: 20px 40px;
            border-radius: 20px; border: 3px dashed var(--primary);
            box-shadow: 8px 8px 0 rgba(0,0,0,0.05);
            max-width: 800px; width: 100%; position: relative;
        }

        header h1 { color: var(--primary); margin: 0; font-weight: 800; font-size: 1.8rem; }
        .subtitle { color: #636e72; font-weight: 600; margin-top: 5px; }

        .btn-print {
            position: absolute; top: 20px; right: 20px;
            background: none; border: 2px solid var(--primary); color: var(--primary);
            padding: 8px 15px; border-radius: 20px; font-weight: 700; cursor: pointer; transition: 0.3s;
        }
        .btn-print:hover { background: var(--primary); color: white; }

        /* --- WIZARD --- */
        .wizard-container {
            width: 100%; max-width: 800px;
            background: white; border-radius: 25px;
            padding: 40px; box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border: 1px solid #eee; position: relative; overflow: hidden;
        }

        .progress-bar {
            width: 100%; height: 10px; background: #f1f2f6;
            border-radius: 5px; margin-bottom: 30px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; background: var(--accent); width: 25%;
            transition: width 0.4s ease; border-radius: 5px;
        }

        .step { display: none; animation: fadeIn 0.5s ease; }
        .step.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        label { display: block; font-weight: 700; margin-bottom: 10px; color: var(--text); font-size: 1.1rem; }
        .input-group { margin-bottom: 25px; }
        
        input[type="text"], textarea {
            width: 100%; padding: 15px; border: 2px solid #dfe6e9;
            border-radius: 12px; font-family: inherit; font-size: 1rem;
            transition: 0.3s; background: #fdfdfd; resize: vertical;
        }
        input[type="text"]:focus, textarea:focus { border-color: var(--primary); outline: none; background: white; }

        /* Sliders */
        .range-container { margin: 20px 0; }
        .range-header { display: flex; justify-content: space-between; font-weight: bold; color: var(--primary); }
        input[type=range] { width: 100%; -webkit-appearance: none; background: transparent; margin: 15px 0; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 10px; background: var(--range-track); border-radius: 5px; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 25px; width: 25px; border-radius: 50%; background: var(--primary); cursor: pointer; margin-top: -8px; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

        .nav-buttons { display: flex; justify-content: space-between; margin-top: 30px; }
        .btn { padding: 12px 30px; border-radius: 30px; font-weight: 800; cursor: pointer; border: none; font-size: 1rem; transition: 0.3s; display: flex; align-items: center; gap: 10px; }
        .btn-prev { background: #dfe6e9; color: #636e72; }
        .btn-next { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3); }
        .btn-next:hover { background: var(--primary-dark); transform: translateY(-2px); }

        /* Resultado */
        .result-card { background: #f8f9fa; border: 2px dashed var(--primary); border-radius: 20px; padding: 30px; text-align: center; }
        .comparison-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comp-box { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .comp-val { font-size: 2.5rem; font-weight: 800; color: var(--primary); }
        
        .btn-back-home { margin-top: 40px; color: #b2bec3; text-decoration: none; font-weight: 600; }

        /* --- ÁREA DE RELATÓRIO (Oculta na tela, visível na impressão) --- */
        #print-report {
            display: none; /* Escondido na tela normal */
            background: white;
            padding: 40px;
            max-width: 100%;
        }

        .report-header {
            text-align: center; border-bottom: 2px solid #ccc; padding-bottom: 20px; margin-bottom: 30px;
        }
        .report-section {
            margin-bottom: 25px; border-bottom: 1px dashed #eee; padding-bottom: 15px;
        }
        .report-label {
            font-weight: bold; color: #555; font-size: 0.9rem; text-transform: uppercase; margin-bottom: 5px;
        }
        .report-value {
            font-size: 1.1rem; color: #000; line-height: 1.5; white-space: pre-wrap;
        }
        .report-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 10px;
        }
        .report-box {
            border: 1px solid #ddd; padding: 10px; border-radius: 8px; background: #f9f9f9;
        }

        /* --- IMPRESSÃO --- */
        @media print {
            /* Esconde tudo o que é da tela */
            header, .wizard-container, .btn-back-home, .nav-buttons, button {
                display: none !important;
            }
            
            /* Mostra e formata o relatório */
            body {
                background: white; margin: 0; padding: 0;
            }
            #print-report {
                display: block !important;
                position: absolute;
                top: 0; left: 0; width: 100%;
                border: none;
            }
            
            /* Ajuste de cores para sair no papel */
            * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        }
    </style>
</head>
<body>

    <header data-aos="fade-down">
        <button class="btn-print" onclick="prepareAndPrint()"><i class="fa-solid fa-print"></i> <span>Imprimir Completo</span></button>
        <h1>Desconstruindo o "Deveria"</h1>
        <div class="subtitle">Ferramenta Cognitiva (Leahy)</div>
    </header>

    <div class="wizard-container" data-aos="fade-up">
        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>

        <div class="step active" id="step1">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-magnifying-glass"></i> Passo 1: O Peso da Regra</h2>
            <div class="input-group">
                <label>Qual é a afirmação "deveria" que te incomoda?</label>
                <input type="text" id="statement" placeholder='Ex: "Eu deveria ter feito melhor"'>
            </div>
            <div class="range-container">
                <div class="range-header"><span>Quanto você acredita nisso?</span><span id="beliefVal1">0%</span></div>
                <input type="range" id="belief1" min="0" max="100" value="0" oninput="updateRange('belief1', 'beliefVal1')">
            </div>
            <div class="input-group">
                <label>Qual emoção você sente?</label>
                <input type="text" id="emotion" placeholder="Ex: Culpa, Ansiedade">
            </div>
            <div class="range-container">
                <div class="range-header"><span>Intensidade da Emoção:</span><span id="emotionVal1">0%</span></div>
                <input type="range" id="emotion1" min="0" max="100" value="0" oninput="updateRange('emotion1', 'emotionVal1')">
            </div>
            <div class="nav-buttons" style="justify-content: flex-end;">
                <button class="btn btn-next" onclick="nextStep(2)">Continuar <i class="fa-solid fa-arrow-right"></i></button>
            </div>
        </div>

        <div class="step" id="step2">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-scale-balanced"></i> Passo 2: Custo-Benefício</h2>
            <div class="input-group">
                <label>Quais os BENEFÍCIOS de pensar assim?</label>
                <textarea id="benefits" rows="3"></textarea>
            </div>
            <div class="input-group">
                <label style="color:#d63031">Quais os CUSTOS de pensar assim?</label>
                <textarea id="costs" rows="3"></textarea>
            </div>
            <div class="input-group">
                <label>Quem estabeleceu essa regra?</label>
                <input type="text" id="source">
            </div>
            <div class="nav-buttons">
                <button class="btn btn-prev" onclick="prevStep(1)">Voltar</button>
                <button class="btn btn-next" onclick="nextStep(3)">Continuar</button>
            </div>
        </div>

        <div class="step" id="step3">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-glasses"></i> Passo 3: Mudando a Lente</h2>
            <div class="input-group">
                <label>Você aplica esta regra a todos? Por que não?</label>
                <textarea id="applyOthers" rows="3"></textarea>
            </div>
            <div class="input-group">
                <label style="color:var(--primary)">Reexpresse como PREFERÊNCIA:</label>
                <input type="text" id="preference" placeholder='Ex: "Eu preferiria..."'>
            </div>
            <div class="nav-buttons">
                <button class="btn btn-prev" onclick="prevStep(2)">Voltar</button>
                <button class="btn btn-next" onclick="nextStep(4)">Continuar</button>
            </div>
        </div>

        <div class="step" id="step4">
            <h2 style="color:var(--primary)"><i class="fa-solid fa-rotate"></i> Passo 4: Conclusão</h2>
            <div class="input-group">
                <label>Qual seria uma expectativa mais razoável?</label>
                <textarea id="reasonable" rows="3"></textarea>
            </div>
            <hr style="margin:20px 0; border:0; border-top:1px dashed #ccc;">
            <p style="text-align:center; font-weight:bold;">Reavaliação Final</p>
            <div class="range-container">
                <div class="range-header"><span>Novo grau de crença:</span><span id="beliefVal2">0%</span></div>
                <input type="range" id="belief2" min="0" max="100" value="0" oninput="updateRange('belief2', 'beliefVal2')">
            </div>
            <div class="range-container">
                <div class="range-header"><span>Nova intensidade da emoção:</span><span id="emotionVal2">0%</span></div>
                <input type="range" id="emotion2" min="0" max="100" value="0" oninput="updateRange('emotion2', 'emotionVal2')">
            </div>
            <div class="nav-buttons">
                <button class="btn btn-prev" onclick="prevStep(3)">Voltar</button>
                <button class="btn btn-next" onclick="showResults()" style="background:#00b894">Concluir <i class="fa-solid fa-check"></i></button>
            </div>
        </div>

        <div class="step" id="stepResult">
            <div class="result-card">
                <i class="fa-solid fa-trophy" style="font-size:3rem; color:#f1c40f; margin-bottom:15px;"></i>
                <h2>Exercício Concluído!</h2>
                <div class="comparison-grid">
                    <div class="comp-box">
                        <div style="color:#b2bec3; font-weight:bold; font-size:0.8rem;">ANTES</div>
                        <div id="res-belief1" style="font-size:1.5rem; font-weight:bold; color:#636e72;"></div>
                    </div>
                    <div class="comp-box">
                        <div style="color:#00b894; font-weight:bold; font-size:0.8rem;">AGORA</div>
                        <div id="res-belief2" style="font-size:2rem; font-weight:bold; color:#00b894;"></div>
                    </div>
                </div>
                <div style="background:#e0f7fa; padding:15px; border-radius:10px; color:#006064; margin-top:20px;">
                    <strong>Nova Perspectiva:</strong><br>
                    <span id="res-preference"></span>
                </div>
                <button class="btn btn-next" onclick="prepareAndPrint()" style="margin: 30px auto; background:#2d3436;">
                    <i class="fa-solid fa-print"></i> Imprimir Tudo
                </button>
            </div>
        </div>
    </div>

    <div id="print-report">
        <div class="report-header">
            <h2>Relatório: Exame e Contestação de "Deveria"</h2>
            <p>Psicólogo Bruno de Souza</p>
        </div>

        <div class="report-section">
            <div class="report-label">1. Afirmação do tipo "Deveria"</div>
            <div class="report-value" id="p-statement"></div>
            
            <div class="report-grid">
                <div class="report-box">
                    <div class="report-label">Grau Inicial de Crença</div>
                    <div class="report-value" id="p-belief1"></div>
                </div>
                <div class="report-box">
                    <div class="report-label">Emoção e Intensidade</div>
                    <div class="report-value"><span id="p-emotion"></span> (<span id="p-emotion1"></span>)</div>
                </div>
            </div>
        </div>

        <div class="report-section">
            <div class="report-grid">
                <div>
                    <div class="report-label">Custos</div>
                    <div class="report-value" id="p-costs"></div>
                </div>
                <div>
                    <div class="report-label">Benefícios</div>
                    <div class="report-value" id="p-benefits"></div>
                </div>
            </div>
            <br>
            <div class="report-label">Quem estabeleceu esta regra?</div>
            <div class="report-value" id="p-source"></div>
        </div>

        <div class="report-section">
            <div class="report-label">Você aplica esta regra a todos? Por que não?</div>
            <div class="report-value" id="p-applyOthers"></div>
        </div>

        <div class="report-section" style="background:#f0f8ff; padding:15px; border-radius:10px;">
            <div class="report-label" style="color:#0984e3">Reexpressão como PREFERÊNCIA</div>
            <div class="report-value" id="p-preference" style="font-weight:bold;"></div>
            <br>
            <div class="report-label" style="color:#0984e3">Expectativa Razoável</div>
            <div class="report-value" id="p-reasonable"></div>
        </div>

        <div class="report-section">
            <div class="report-label">Reavaliação Final</div>
            <div class="report-grid">
                <div class="report-box">
                    <div class="report-label">Novo Grau de Crença</div>
                    <div class="report-value" id="p-belief2"></div>
                </div>
                <div class="report-box">
                    <div class="report-label">Nova Emoção</div>
                    <div class="report-value" id="p-emotion2"></div>
                </div>
            </div>
        </div>
    </div>

    <a href="../listaferramentas.html" class="btn-back-home"><i class="fa-solid fa-arrow-left"></i> Voltar para Ferramentas</a>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init();
        let currentStep = 1;
        const totalSteps = 4;

        function updateRange(id, valId) { document.getElementById(valId).innerText = document.getElementById(id).value + "%"; }

        function showStep(step) {
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById(`step${step}`).classList.add('active');
            let percent = (step / (totalSteps + 1)) * 100;
            if(step > totalSteps) percent = 100;
            document.getElementById('progressFill').style.width = percent + "%";
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextStep(step) { showStep(step); }
        function prevStep(step) { showStep(step); }

        function showResults() {
            // Visualização na tela
            document.getElementById('res-belief1').innerText = document.getElementById('belief1').value + "%";
            document.getElementById('res-belief2').innerText = document.getElementById('belief2').value + "%";
            document.getElementById('res-preference').innerText = document.getElementById('preference').value || "(Em branco)";
            
            document.querySelectorAll('.step').forEach(el => el.classList.remove('active'));
            document.getElementById('stepResult').classList.add('active');
            document.getElementById('progressFill').style.width = "100%";
        }

        // FUNÇÃO MÁGICA DE IMPRESSÃO
        function prepareAndPrint() {
            // Transfere dados dos inputs para o relatório de impressão
            document.getElementById('p-statement').innerText = document.getElementById('statement').value;
            document.getElementById('p-belief1').innerText = document.getElementById('belief1').value + "%";
            document.getElementById('p-emotion').innerText = document.getElementById('emotion').value;
            document.getElementById('p-emotion1').innerText = document.getElementById('emotion1').value + "%";
            
            document.getElementById('p-costs').innerText = document.getElementById('costs').value;
            document.getElementById('p-benefits').innerText = document.getElementById('benefits').value;
            document.getElementById('p-source').innerText = document.getElementById('source').value;
            
            document.getElementById('p-applyOthers').innerText = document.getElementById('applyOthers').value;
            document.getElementById('p-preference').innerText = document.getElementById('preference').value;
            document.getElementById('p-reasonable').innerText = document.getElementById('reasonable').value;
            
            document.getElementById('p-belief2').innerText = document.getElementById('belief2').value + "%";
            document.getElementById('p-emotion2').innerText = document.getElementById('emotion2').value + "%";

            // Chama a impressão
            window.print();
        }
    </script>

</body>
</html>
