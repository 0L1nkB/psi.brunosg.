<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCID-5-CV: Módulo A (Didático)</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f8f9fa;
            --card: #ffffff;
            --text: #333;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            height: 100vh;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }

        header {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        h1 { margin: 0; font-size: 1.2rem; }
        .badge { background: var(--accent); padding: 5px 10px; border-radius: 4px; font-size: 0.9rem; }

        /* Container Principal */
        #app-container {
            display: flex;
            flex: 1;
            gap: 20px;
            overflow: hidden;
        }

        /* Coluna Esquerda: A Pergunta (Para o Paciente) */
        .question-panel {
            flex: 2;
            background: var(--card);
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .question-code {
            color: var(--accent);
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.5rem;
            line-height: 1.4;
            margin-bottom: 20px;
        }

        .sub-questions {
            font-size: 1.1rem;
            color: #555;
            background: #f1f3f5;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--accent);
            margin-bottom: 20px;
        }

        .instruction {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9rem;
            margin-top: auto;
        }

        /* Coluna Central: Critérios (Para o Médico) */
        .criteria-panel {
            flex: 1;
            background: #e9ecef;
            border-radius: 8px;
            padding: 20px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
        }

        .criteria-title { font-weight: bold; margin-bottom: 10px; color: #495057; }
        .criteria-text { font-size: 0.95rem; color: #495057; }

        /* Coluna Direita: Ações */
        .action-panel {
            flex: 0 0 150px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 20px 10px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.2s;
            color: white;
            text-transform: uppercase;
        }

        .btn:hover { opacity: 0.9; transform: scale(1.02); }
        .btn-plus { background-color: var(--danger); } /* Presente/Patológico */
        .btn-minus { background-color: var(--success); } /* Ausente/Saudável */
        .btn-unsure { background-color: #6c757d; } /* Duvidoso */

        /* Tela de Resultados */
        #results-view {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 8px;
            flex: 1;
            overflow-y: auto;
        }

        .result-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }
        
        .diagnosis-box {
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .diag-positive { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .diag-negative { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }

    </style>
</head>
<body>

    <header>
        <div>
            <h1>SCID-5-CV Digital</h1>
            <span style="font-size:0.8rem; opacity:0.8;">Uso Pessoal Didático</span>
        </div>
        <div class="badge" id="progress-display">Item 1</div>
    </header>

    <div id="app-container">
        
        <div class="question-panel">
            <span class="question-code" id="q-id">A1</span>
            <div class="question-text" id="q-main">
                Carregando pergunta...
            </div>
            
            <div class="sub-questions" id="q-sub" style="display:none;">
                </div>

            <div class="instruction" id="q-inst" style="display:none;">
                </div>
        </div>

        <div class="criteria-panel">
            <div class="criteria-title">Critério DSM-5</div>
            <div class="criteria-text" id="c-text">
                Carregando critério...
            </div>
        </div>

        <div class="action-panel">
            <button class="btn btn-plus" onclick="registerScore('+')">+ (Presente)</button>
            <button class="btn btn-minus" onclick="registerScore('-')">- (Ausente)</button>
            <button class="btn btn-unsure" onclick="registerScore('?')">? (Dúvida)</button>
        </div>
    </div>

    <div id="results-view">
        <h2>Sumário do Módulo A</h2>
        <div id="score-list"></div>
        <div id="final-diagnosis" class="diagnosis-box"></div>
        <button class="btn btn-unsure" style="margin-top:20px;" onclick="location.reload()">Reiniciar</button>
    </div>

    <script>
        // ============================================================
        // BANCO DE DADOS DAS PERGUNTAS (Extraído do PDF/Guia SCID-5)
        // ============================================================
        const questions = [
            {
                id: "A1",
                text: "No último mês, houve algum período de tempo em que você se sentiu deprimido ou abatido na maior parte do dia, quase todos os dias?",
                sub: "Alguém disse que você parece triste, abatido ou deprimido?",
                criteria: "1. Humor deprimido na maior parte do dia, quase todos os dias, indicado por relato subjetivo (p. ex., sente-se triste, vazio, sem esperança) ou observação de terceiros.",
                inst: "Se o paciente estiver visivelmente deprimido, você pode classificar como (+) mesmo se ele negar, baseado na observação."
            },
            {
                id: "A2",
                text: "Durante esse período, você sentiu menos interesse ou prazer com coisas de que normalmente gosta?",
                sub: "Houve um período em que você perdeu o interesse ou o prazer por quase todas as atividades?",
                criteria: "2. Acentuada diminuição de interesse ou prazer em todas, ou quase todas, as atividades na maior parte do dia, quase todos os dias."
            },
            // PONTO DE CHECAGEM CRÍTICO DA SCID
            {
                id: "CHECK_ENTRY",
                type: "logic",
                check: function(scores) {
                    // Se não tiver nem A1 nem A2 positivos, não é depressão. Pula.
                    if (scores['A1'] !== '+' && scores['A2'] !== '+') {
                        return 'SKIP_TO_END';
                    }
                    return 'NEXT';
                }
            },
            {
                id: "A3",
                text: "Como estava o seu apetite? Houve alguma mudança significativa?",
                sub: "Você teve que se forçar a comer? Ou comeu muito mais do que o habitual? Houve perda ou ganho de peso?",
                criteria: "3. Perda ou ganho significativo de peso sem estar fazendo dieta (p. ex., 5% em um mês), ou diminuição/aumento do apetite quase todos os dias."
            },
            {
                id: "A4",
                text: "Como você estava dormindo?",
                sub: "Teve dificuldade para pegar no sono? Acordou no meio da noite? Ou dormiu muito mais do que o normal?",
                criteria: "4. Insônia ou hipersonia quase todos os dias."
            },
            {
                id: "A5",
                text: "Você tem se sentido inquieto ou agitado, a ponto de não conseguir ficar parado?",
                sub: "Ou, pelo contrário, tem se sentido mais lento? Como se estivesse se movendo em câmera lenta, ou demorando para falar?",
                criteria: "5. Agitação ou retardo psicomotor quase todos os dias (observável por outras pessoas, não apenas sensação subjetiva).",
                inst: "Atenção: A mera sensação subjetiva não conta. Deve ser observável."
            },
            {
                id: "A6",
                text: "Como tem estado sua energia? Tem se sentido cansado ou sem energia?",
                sub: "Você se sente cansado mesmo sem fazer esforço físico?",
                criteria: "6. Fadiga ou perda de energia quase todos os dias."
            },
            {
                id: "A7",
                text: "Como você tem se sentido em relação a si mesmo? Tem tido sentimentos de inutilidade?",
                sub: "Tem se sentido culpado em relação a coisas que fez ou deixou de fazer? (Essa culpa é excessiva?)",
                criteria: "7. Sentimentos de inutilidade ou culpa excessiva ou inapropriada (que pode ser delirante) quase todos os dias."
            },
            {
                id: "A8",
                text: "Tem tido dificuldade para pensar ou se concentrar?",
                sub: "Tem sido difícil tomar decisões sobre coisas cotidianas?",
                criteria: "8. Capacidade diminuída para pensar ou se concentrar, ou indecisão, quase todos os dias."
            },
            {
                id: "A9",
                text: "Você tem tido pensamentos de que seria melhor estar morto, ou pensamentos de se machucar?",
                sub: "Pensou em suicídio? Chegou a planejar como faria?",
                criteria: "9. Pensamentos recorrentes de morte (não somente medo de morrer), ideação suicida recorrente sem um plano específico, tentativa de suicídio ou plano específico.",
                inst: "ALERTA DE SEGURANÇA: Se responder SIM, avalie o risco de suicídio imediato."
            }
        ];

        // ============================================================
        // MOTOR DO APLICATIVO
        // ============================================================
        let currentIndex = 0;
        let scores = {};

        function loadQuestion() {
            if (currentIndex >= questions.length) {
                showResults();
                return;
            }

            const q = questions[currentIndex];

            // Processa Lógica (Itens invisíveis)
            if (q.type === 'logic') {
                const action = q.check(scores);
                if (action === 'SKIP_TO_END') {
                    showResults(true); // True indica pulo por falta de critério
                    return;
                } else {
                    currentIndex++;
                    loadQuestion();
                    return;
                }
            }

            // Atualiza UI
            document.getElementById('q-id').innerText = q.id;
            document.getElementById('q-main').innerText = q.text;
            document.getElementById('c-text').innerText = q.criteria;
            document.getElementById('progress-display').innerText = `Item ${currentIndex + 1} de ${questions.length}`;

            // Sub-perguntas
            const subDiv = document.getElementById('q-sub');
            if (q.sub) {
                subDiv.style.display = 'block';
                subDiv.innerText = q.sub;
            } else {
                subDiv.style.display = 'none';
            }

            // Instruções
            const instDiv = document.getElementById('q-inst');
            if (q.inst) {
                instDiv.style.display = 'block';
                instDiv.innerText = "NOTA PARA O CLÍNICO: " + q.inst;
            } else {
                instDiv.style.display = 'none';
            }
        }

        function registerScore(value) {
            const q = questions[currentIndex];
            scores[q.id] = value;
            currentIndex++;
            loadQuestion();
        }

        function showResults(skipped = false) {
            document.getElementById('app-container').style.display = 'none';
            document.getElementById('results-view').style.display = 'block';
            
            const list = document.getElementById('score-list');
            const diagBox = document.getElementById('final-diagnosis');
            list.innerHTML = '';

            let positiveCount = 0;
            let hasA1 = scores['A1'] === '+';
            let hasA2 = scores['A2'] === '+';

            // Gera lista visual
            Object.keys(scores).forEach(key => {
                const val = scores[key];
                if (val === '+') positiveCount++;
                
                const div = document.createElement('div');
                div.className = 'result-item';
                div.innerHTML = `<strong>${key}</strong> <b>${val}</b>`;
                list.appendChild(div);
            });

            // Lógica de Diagnóstico (Simplificada para fins didáticos)
            // DSM-5: 5 ou mais sintomas, sendo obrigatório A1 ou A2.
            
            if (skipped) {
                diagBox.className = "diagnosis-box diag-negative";
                diagBox.innerHTML = "CRITÉRIOS NÃO ATENDIDOS<br><small>O paciente não apresentou os sintomas fundamentais (A1 ou A2).</small>";
            } else if ((hasA1 || hasA2) && positiveCount >= 5) {
                diagBox.className = "diagnosis-box diag-positive";
                diagBox.innerHTML = `POSSÍVEL EPISÓDIO DEPRESSIVO MAIOR<br><small>Critérios atendidos: ${positiveCount}/9 (Mínimo 5)</small>`;
            } else {
                diagBox.className = "diagnosis-box diag-negative";
                diagBox.innerHTML = `ABAIXO DO LIMIAR DIAGNÓSTICO<br><small>Critérios atendidos: ${positiveCount}/9. Necessário 5.</small>`;
            }
        }

        // Iniciar
        loadQuestion();

    </script>
</body>
</html>
